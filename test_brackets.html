<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test - Sistema de Brackets</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 20px; border: 1px solid #ccc; }
        .button { padding: 10px 20px; margin: 10px; background: #007bff; color: white; border: none; cursor: pointer; }
        .button:hover { background: #0056b3; }
        .success { color: green; font-weight: bold; }
        .error { color: red; font-weight: bold; }
        .info { color: blue; }
    </style>
</head>
<body>
    <h1>üß™ Test Sistema de Brackets (Fase B)</h1>
    
    <div class="test-section">
        <h2>Test 1: Crear Torneo de 6 Competidores</h2>
        <button class="button" onclick="testBrackets6()">üéØ Test 6 Competidores (2 llaves de 3)</button>
        <div id="result6"></div>
    </div>

    <div class="test-section">
        <h2>Test 2: Crear Torneo de 8 Competidores</h2>
        <button class="button" onclick="testBrackets8()">üéØ Test 8 Competidores (2 llaves de 4)</button>
        <div id="result8"></div>
    </div>

    <div class="test-section">
        <h2>Diagn√≥stico de Funciones</h2>
        <button class="button" onclick="diagnoseFunctions()">üîç Verificar Funciones Clave</button>
        <div id="diagnosis"></div>
    </div>

    <script src="script.js"></script>
    <script>
        function testBrackets6() {
            const result = document.getElementById('result6');
            result.innerHTML = '<div class="info">Iniciando test...</div>';
            
            try {
                // Simular torneo de 6 competidores
                const tournament = new RoundRobinTournament();
                
                // Configurar torneo
                tournament.competitorCount = 6;
                tournament.competitors = [
                    {id: 1, name: 'Competidor A1', wins: 0, ties: 0, losses: 0, victoryPoints: 0, judgePoints: 0, tiebreakerWins: 0},
                    {id: 2, name: 'Competidor A2', wins: 0, ties: 0, losses: 0, victoryPoints: 0, judgePoints: 0, tiebreakerWins: 0},
                    {id: 3, name: 'Competidor A3', wins: 0, ties: 0, losses: 0, victoryPoints: 0, judgePoints: 0, tiebreakerWins: 0},
                    {id: 4, name: 'Competidor B1', wins: 0, ties: 0, losses: 0, victoryPoints: 0, judgePoints: 0, tiebreakerWins: 0},
                    {id: 5, name: 'Competidor B2', wins: 0, ties: 0, losses: 0, victoryPoints: 0, judgePoints: 0, tiebreakerWins: 0},
                    {id: 6, name: 'Competidor B3', wins: 0, ties: 0, losses: 0, victoryPoints: 0, judgePoints: 0, tiebreakerWins: 0}
                ];
                
                // Crear brackets
                tournament.createBrackets();
                
                let output = '<div class="success">‚úÖ Test 6 competidores completado</div>';
                output += `<div>Brackets creados: ${tournament.brackets.length}</div>`;
                
                tournament.brackets.forEach((bracket, index) => {
                    output += `<div><strong>${bracket.name}:</strong> ${bracket.competitors.map(c => c.name).join(', ')}</div>`;
                });
                
                // Generar peleas de fase de grupos
                tournament.generateGroupStage();
                output += `<div>Peleas generadas: ${tournament.fights.length}</div>`;
                
                result.innerHTML = output;
                
            } catch (error) {
                result.innerHTML = `<div class="error">‚ùå Error: ${error.message}</div>`;
                console.error('Error en test:', error);
            }
        }

        function testBrackets8() {
            const result = document.getElementById('result8');
            result.innerHTML = '<div class="info">Iniciando test...</div>';
            
            try {
                const tournament = new RoundRobinTournament();
                
                tournament.competitorCount = 8;
                tournament.competitors = [];
                for (let i = 1; i <= 8; i++) {
                    tournament.competitors.push({
                        id: i, 
                        name: `Competidor ${i}`, 
                        wins: 0, ties: 0, losses: 0, 
                        victoryPoints: 0, judgePoints: 0, tiebreakerWins: 0
                    });
                }
                
                tournament.createBrackets();
                
                let output = '<div class="success">‚úÖ Test 8 competidores completado</div>';
                output += `<div>Brackets creados: ${tournament.brackets.length}</div>`;
                
                tournament.brackets.forEach((bracket, index) => {
                    output += `<div><strong>${bracket.name}:</strong> ${bracket.competitors.map(c => c.name).join(', ')}</div>`;
                });
                
                tournament.generateGroupStage();
                output += `<div>Peleas generadas: ${tournament.fights.length}</div>`;
                
                result.innerHTML = output;
                
            } catch (error) {
                result.innerHTML = `<div class="error">‚ùå Error: ${error.message}</div>`;
                console.error('Error en test:', error);
            }
        }

        function diagnoseFunctions() {
            const result = document.getElementById('diagnosis');
            let output = '<div class="info">Verificando funciones...</div>';
            
            try {
                const tournament = new RoundRobinTournament();
                
                // Verificar funciones clave
                const functions = [
                    'createBrackets',
                    'generateGroupStage', 
                    'resolveBracketIfComplete',
                    'checkAndGenerateFinalIfReady',
                    'determineGroupWinners',
                    'generateFinalFight'
                ];
                
                functions.forEach(funcName => {
                    if (typeof tournament[funcName] === 'function') {
                        output += `<div class="success">‚úÖ ${funcName}: Funci√≥n existe</div>`;
                    } else {
                        output += `<div class="error">‚ùå ${funcName}: Funci√≥n NO encontrada</div>`;
                    }
                });
                
                result.innerHTML = output;
                
            } catch (error) {
                result.innerHTML = `<div class="error">‚ùå Error en diagn√≥stico: ${error.message}</div>`;
                console.error('Error en diagn√≥stico:', error);
            }
        }
    </script>
</body>
</html>